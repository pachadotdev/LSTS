<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Whittle estimator to Locally Stationary Time Series — ls_whittle • lsts</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Whittle estimator to Locally Stationary Time Series — ls_whittle" />
<meta property="og:description" content="This function computes Whittle estimator to LS-ARMA and
LS-ARFIMA models." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lsts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pachamaltese/lsts/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Whittle estimator to Locally Stationary Time Series</h1>
    <small class="dont-index">Source: <a href='https://github.com/pachamaltese/lsts/blob/master/R/ls_whittle.R'><code>R/ls_whittle.R</code></a></small>
    <div class="hidden name"><code>ls_whittle.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes Whittle estimator to LS-ARMA and
LS-ARFIMA models.</p>
    </div>

    <pre class="usage"><span class='fu'>ls_whittle</span>(
  <span class='no'>series</span>,
  <span class='no'>start</span>,
  <span class='kw'>order</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='fl'>0</span>),
  <span class='kw'>ar_order</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ma_order</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sd_order</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>d_order</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>include_d</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>w</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>s</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>include_taper</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>lower</span> <span class='kw'>=</span> -<span class='fl'>Inf</span>,
  <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>m</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>n_ahead</span> <span class='kw'>=</span> <span class='fl'>0</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>series</th>
      <td><p>(type: numeric) univariate time series.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>(type: numeric) numeric vector, initial values for parameters to
run the model.</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>(type: numeric) vector corresponding to <code>ARMA</code> model
entered.</p></td>
    </tr>
    <tr>
      <th>ar_order</th>
      <td><p>(type: numeric) AR polimonial order.</p></td>
    </tr>
    <tr>
      <th>ma_order</th>
      <td><p>(type: numeric) MA polimonial order.</p></td>
    </tr>
    <tr>
      <th>sd_order</th>
      <td><p>(type: numeric) polinomial order noise scale factor.</p></td>
    </tr>
    <tr>
      <th>d_order</th>
      <td><p>(type: numeric) <code>d</code> polinomial order, where <code>d</code> is
the <code>ARFIMA</code> parameter.</p></td>
    </tr>
    <tr>
      <th>include_d</th>
      <td><p>(type: numeric) logical argument for <code>ARFIMA</code> models.
If <code>include_d=FALSE</code> then the model is an ARMA process.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>(type: numeric) value corresponding to the length of the window to
compute periodogram. If <code>w=NULL</code> then the function will use
\(w = \text{trunc}(n^{0.8})\), see Dahlhaus (1998) where \(n\) is the
length of the <code>y</code> vector.</p></td>
    </tr>
    <tr>
      <th>s</th>
      <td><p>(type: numeric) value corresponding to the lag with which will go
taking the blocks or windows.</p></td>
    </tr>
    <tr>
      <th>include_taper</th>
      <td><p>(type: logical) logical argument that by default is
<code>TRUE</code>. See <code><a href='periodogram.html'>periodogram</a></code>.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>(type: list) A list of control parameters. More details in
<code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code> .</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>(type: numeric) lower bound, replicated to be as long as
<code>start</code>. If unspecified, all parameters are assumed to be lower
unconstrained.</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>(type: numeric) upper bound, replicated to be as long as
<code>start</code>. If unspecified, all parameters are assumed to be upper
unconstrained.</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>(type: numeric) truncation order of the MA infinity process, by
default \(m = 0.25n^{0.8}\). Parameter used in <code>lsts_kalman</code>.</p></td>
    </tr>
    <tr>
      <th>n_ahead</th>
      <td><p>(type: numeric) The number of steps ahead for which prediction
is required. By default is zero.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following components:</p>
<dt>coef </dt><dd><p>The best set of parameters found.</p></dd>
<dt>var.coef </dt><dd><p>covariance matrix approximated for maximum likelihood
estimator \(\hat{\theta}\) of
\(\theta:=(\theta_1,\ldots,\theta_k)^{\prime}\). This matrix is
approximated by \(H^{-1}/n\), where \(H\) is the Hessian matrix
\([\partial^2 \ell(\theta)/\partial\theta_i
\partial\theta_j]_{i,j=1}^{k}\).</p></dd>
<dt>loglik </dt><dd><p>log-likelihood of <code>coef</code>, calculated with
<code>ls_whittle</code>.</p></dd>
<dt>aic </dt><dd><p>Akaike's `An Information Criterion', for one fitted model LS-ARMA
or LS-ARFIMA. The formula is \(-2L + 2k/n\), where <em>L</em> represents the
log-likelihood, <em>k</em> represents the number of parameters in the fitted
model and <em>n</em> is equal to the length of the <code>series</code>.</p></dd>
<dt>series </dt><dd><p>original time serie.</p></dd>
<dt>residuals </dt><dd><p>standard residuals.</p></dd>
<dt>fitted.values </dt><dd><p>model fitted values.</p></dd>
<dt>pred </dt><dd><p>predictions of the model.</p></dd>
<dt>se</dt><dd><p>the estimated standard errors.</p></dd>
<dt>model </dt><dd><p>A list representing the fitted model.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function estimates the parameters in models: LS-ARMA
$$\Phi(t/T, \, B)\, Y_{t, T} = \Theta(t/T,\, B)\,\sigma(t/T)\,
\varepsilon_t$$ and LS-ARFIMA $$\Phi(t/T, \, B)\, Y_{t, T} =
\Theta(t/T,\, B)\, (1-B)^{-d(t/T)}\, \sigma(t/T)\, \varepsilon_t,$$
with infinite moving average expansion
$$Y_{t, T} = \sigma(t/T)\, \sum_{j=0}^{\infty}
\psi(t/T)\,\varepsilon_t,$$ for \(t = 1,\ldots, T\), where for
\(u = t/T \in [0,1]\), \(\Phi(u,B)=1+\phi_1(u)B +\cdots+\phi_p(u)B^p\)
is an autoregressive polynomial,
\(\Theta(u, B) = 1 + \theta_1(u)B + \cdots  + \theta_q(u)B^q\) is a
moving average polynomial, \(d(u)\) is a long-memory parameter,
\(\sigma(u)\) is a noise scale factor and \(\{\varepsilon_t \}\) is a
Gaussian white noise sequence with zero mean and unit variance. This class
of models extends the well-known ARMA and ARFIMA process, which is obtained
when the components \(\Phi(u, B)\), \(\Theta(u, B)\), \(d(u)\) and
\(\sigma(u)\) do not depend on \(u\).
The evolution of these models can be specified in terms of a general class
of functions. For example, let \(\{g_j(u)\}\), \(j = 1, 2, \ldots\), be
a basis for a space of smoothly varying functions and let
\(d_{\theta}(u)\) be the time-varying long-memory parameter in model
LS-ARFIMA. Then we could write \(d_{\theta}(u)\) in terms of the basis
\(\{g_j(u) = u^j\}\) as follows
\(d_{\theta}(u) = \sum_{j=0}^{k} \alpha_j\,g_j(u)\)
for unknown values of \(k\) and
\(\theta = (\alpha_0,\,\alpha_1,\,\ldots, \,\alpha_k)^{\prime}\).
In this situation, estimating \(\theta\) involves determining \(k\) and
estimating the coefficients \(\alpha_0,\,\alpha_1,\,\ldots, \,\alpha_k\).
<code>ls_whittle</code> optimizes <code><a href='ls_whittle_loglik.html'>ls_whittle_loglik</a></code> as objective
function using <code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code> function, for both LS-ARMA
(<code>include_d=FALSE</code>) and LS-ARFIMA (<code>include_d=TRUE</code>) models.
Also computes Kalman filter with <code><a href='ls_kalman.html'>ls_kalman</a></code> and this values
are given in <code>var.coef</code> in the output.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code>, <code><a href='ls_kalman.html'>ls_kalman</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Analysis by blocks of phi and sigma parameters</span>
<span class='no'>w</span> <span class='kw'>&lt;-</span> <span class='fl'>200</span>
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
<span class='no'>M</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>trunc</a></span>((<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>malleco</span>) - <span class='no'>w</span>) / <span class='no'>s</span> + <span class='fl'>1</span>)
<span class='no'>table</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>()
<span class='kw'>for</span> (<span class='no'>j</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>M</span>) {
  <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>malleco</span>[(<span class='fl'>1</span> + <span class='no'>s</span> * (<span class='no'>j</span> - <span class='fl'>1</span>)):(<span class='no'>w</span> + <span class='no'>s</span> * (<span class='no'>j</span> - <span class='fl'>1</span>))]
  <span class='no'>table</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>table</span>, <span class='fu'><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></span>(
    <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.65</span>, <span class='fl'>0.15</span>), <span class='kw'>w</span> <span class='kw'>=</span> <span class='no'>w</span>,
    <span class='kw'>objective</span> <span class='kw'>=</span> <span class='no'>ls_whittle_loglik</span>,
    <span class='kw'>series</span> <span class='kw'>=</span> <span class='no'>x</span>, <span class='kw'>order</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='fl'>0</span>)
  )$<span class='no'>par</span>)
}
<span class='no'>u</span> <span class='kw'>&lt;-</span> (<span class='no'>w</span> / <span class='fl'>2</span> + <span class='no'>s</span> * (<span class='fl'>1</span>:<span class='no'>M</span> - <span class='fl'>1</span>)) / <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>malleco</span>)
<span class='no'>table</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>u</span>, <span class='no'>table</span>))
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>table</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"u"</span>, <span class='st'>"phi"</span>, <span class='st'>"sigma"</span>)
<span class='co'># Start parameters</span>
<span class='no'>phi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline</a></span>(<span class='no'>table</span>$<span class='no'>phi</span>, <span class='kw'>spar</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>0.01</span>)$<span class='no'>y</span>
<span class='no'>fit.1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='no'>phi</span> ~ <span class='no'>a0</span> + <span class='no'>a1</span> * <span class='no'>u</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>a0</span> <span class='kw'>=</span> <span class='fl'>0.65</span>, <span class='kw'>a1</span> <span class='kw'>=</span> <span class='fl'>0.00</span>))
<span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline</a></span>(<span class='no'>table</span>$<span class='no'>sigma</span>, <span class='kw'>spar</span> <span class='kw'>=</span> <span class='fl'>1</span>)$<span class='no'>y</span>
<span class='no'>fit.2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='no'>sigma</span> ~ <span class='no'>b0</span> + <span class='no'>b1</span> * <span class='no'>u</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>b0</span> <span class='kw'>=</span> <span class='fl'>0.65</span>, <span class='kw'>b1</span> <span class='kw'>=</span> <span class='fl'>0.00</span>))
<span class='no'>fit_whittle</span> <span class='kw'>&lt;-</span> <span class='fu'>ls_whittle</span>(
  <span class='kw'>series</span> <span class='kw'>=</span> <span class='no'>malleco</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>fit.1</span>), <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>fit.2</span>)), <span class='kw'>order</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='fl'>0</span>),
  <span class='kw'>ar_order</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>sd_order</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>w</span> <span class='kw'>=</span> <span class='fl'>180</span>, <span class='kw'>n_ahead</span> <span class='kw'>=</span> <span class='fl'>10</span>
)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ricardo Olea, Wilfredo Palma, Pilar Rubio, Mauricio Vargas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


